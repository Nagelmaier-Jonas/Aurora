@page "/createtrain"
@using Model.Entities.OwnPattern
@using Domain.LogicHandlers

<MudText Typo="Typo.h2">Your Convoy</MudText>
<MudText Typo="Typo.h4">Your Money: @_money €</MudText>

<MudContainer Class="d-flex">
    <DataInitializer Data="Convoy.FrontTruck">
        <ChildComponent>
            <MudCard Class="m-2 w-25">
                <MudCardMedia Image=@("cards/" + @Convoy.FrontTruck.ImageUrl + ".png") Height="200"/>
                <MudCardContent>
                    <MudText Typo="Typo.h5">@Convoy.FrontTruck.Code</MudText>
                </MudCardContent>
                <MudCardActions>
                    <MudButton Variant="Variant.Text" Color="Color.Primary" EndIcon="@Icons.Outlined.Add" OnClick="@(() => _isOpen = !_isOpen)">Addon</MudButton>
                    <MudButton Variant="Variant.Text" Color="Color.Error" EndIcon="@Icons.Outlined.Remove" OnClick="Convoy.RemoveFrontTruck">Delete</MudButton>
                </MudCardActions>
            </MudCard>
        </ChildComponent>
    </DataInitializer>
    @foreach (var wagon in Convoy.Wagons) {
        <MudCard Class="m-2 w-25">
            <MudCardMedia Image=@("cards/" + wagon.ImageUrl + ".png") Height="200"/>
            <MudCardContent>
                <MudText Typo="Typo.h5">@wagon.Code</MudText>
            </MudCardContent>
            <MudCardActions>
                <MudButton Variant="Variant.Text" Color="Color.Primary" EndIcon="@Icons.Outlined.Add" OnClick="@(() => _isOpen = !_isOpen)">Addon</MudButton>
                <MudButton Variant="Variant.Text" Color="Color.Error" EndIcon="@Icons.Outlined.Remove" OnClick="@(() => Convoy.RemoveWagon(wagon))">Delete</MudButton>
            </MudCardActions>
        </MudCard>
    }
    <DataInitializer Data="Convoy.TailTruck">
        <ChildComponent>
            <MudCard Class="m-2 w-25">
                <MudCardMedia Image=@("cards/" + @Convoy.TailTruck.ImageUrl + ".png") Height="200"/>
                <MudCardContent>
                    <MudText Typo="Typo.h5">@Convoy.TailTruck.Code</MudText>
                </MudCardContent>
                <MudCardActions>
                    <MudButton Variant="Variant.Text" Color="Color.Primary" EndIcon="@Icons.Outlined.Add" OnClick="@(() => _isOpen = !_isOpen)">Addon</MudButton>
                    <MudButton Variant="Variant.Text" Color="Color.Error" EndIcon="@Icons.Outlined.Remove" OnClick="Convoy.RemoveTailTruck">Delete</MudButton>
                </MudCardActions>
            </MudCard>
        </ChildComponent>
    </DataInitializer>
</MudContainer>

<MudTabs Elevation="2" Centered="true" Rounded="true" ApplyEffectsToContainer="true" PanelClass="pa-6">
    <MudTabPanel Text="Truck">
        <MudText>Choose your Truck</MudText>
        <MudContainer Class="d-flex">
            @foreach (var truck in VehicleFactory.Trucks) {
                <MudCard Class="w-25 m-2">
                    <MudCardMedia Image=@("cards/" + truck.ImageUrl + ".png") Height="200"/>
                    <MudCardContent>
                        <MudText Typo="Typo.h5">@truck.Code</MudText>
                        <MudText Typo="Typo.body2">@truck.Price €</MudText>
                    </MudCardContent>
                    <MudCardActions>
                        <MudButton Variant="Variant.Text" Color="Color.Primary" EndIcon="@Icons.Outlined.Euro" OnClick="() => Convoy.CanAddTruck(truck)">Buy</MudButton>
                    </MudCardActions>
                </MudCard>
            }
        </MudContainer>
    </MudTabPanel>
    <MudTabPanel Text="Wagon">
        <MudText>Choose your Wagons</MudText>
        <MudContainer Class="d-flex">
            @foreach (var wagon in VehicleFactory.Wagons) {
                <MudCard Class="w-25 m-2">
                    <MudCardMedia Image=@("cards/" + wagon.ImageUrl + ".png") Height="200"/>
                    <MudCardContent>
                        <MudText Typo="Typo.h5">@wagon.Code</MudText>
                        <MudText Typo="Typo.body2">@wagon.Price €</MudText>
                    </MudCardContent>
                    <MudCardActions>
                        <MudButton Variant="Variant.Text" Color="Color.Primary" EndIcon="@Icons.Outlined.Euro" OnClick="() => Convoy.CanAddWagon(wagon)">Buy</MudButton>
                    </MudCardActions>
                </MudCard>
            }
        </MudContainer>
    </MudTabPanel>
</MudTabs>

<MudDrawer @bind-Open="@_isOpen" Anchor="Anchor.Bottom" Elevation="1" Variant="@DrawerVariant.Temporary">
    <MudDrawerHeader>
        <MudText Typo="Typo.h6">Addons</MudText>
    </MudDrawerHeader>
    <MudDrawerContainer Class="d-flex">
        @foreach (var addon in VehicleFactory.Addon) {
            <MudCard Class="w-25 m-2">
                <MudCardMedia Image=@("cards/" + addon.ImageUrl + ".png") Height="200"/>
                <MudCardContent>
                    <MudText Typo="Typo.h5">@addon.Code</MudText>
                    <MudText Typo="Typo.body2">@addon.Price €</MudText>
                </MudCardContent>
                <MudCardActions>
                    <MudButton Variant="Variant.Text" Color="Color.Primary" EndIcon="@Icons.Outlined.Euro" OnClick="() => Convoy.(wagon)">Buy</MudButton>
                </MudCardActions>
            </MudCard>
        }
    </MudDrawerContainer>
</MudDrawer>


@code {
    public Convoy Convoy { get; set; } = new();

    private bool _isOpen;
    private int _money = 400;

    protected override void OnInitialized() {
        base.OnInitialized();
    }


}